{"ast":null,"code":"\"use strict\";\n/**\n * Copyright (c) \"Neo4j\"\n * Neo4j Sweden AB [https://neo4j.com]\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (g && (g = 0, op[0] && (_ = 0)), _) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nvar _a;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint-disable @typescript-eslint/promise-function-async */\n\nvar result_summary_1 = __importDefault(require(\"./result-summary\"));\n\nvar internal_1 = require(\"./internal\");\n\nvar error_1 = require(\"./error\");\n\nvar EMPTY_CONNECTION_HOLDER = internal_1.connectionHolder.EMPTY_CONNECTION_HOLDER;\n/**\n * @private\n * @param {Error} error The error\n * @returns {void}\n */\n\nvar DEFAULT_ON_ERROR = function (error) {\n  // eslint-disable-next-line @typescript-eslint/restrict-plus-operands, @typescript-eslint/no-base-to-string\n  console.log('Uncaught error when processing result: ' + error);\n};\n/**\n * @private\n * @param {ResultSummary} summary\n * @returns {void}\n */\n\n\nvar DEFAULT_ON_COMPLETED = function (summary) {};\n/**\n * @private\n * @param {string[]} keys List of keys of the record in the result\n * @return {void}\n */\n\n\nvar DEFAULT_ON_KEYS = function (keys) {};\n/**\n * A stream of {@link Record} representing the result of a query.\n * Can be consumed eagerly as {@link Promise} resolved with array of records and {@link ResultSummary}\n * summary, or rejected with error that contains {@link string} code and {@link string} message.\n * Alternatively can be consumed lazily using {@link Result#subscribe} function.\n * @access public\n */\n\n\nvar Result =\n/** @class */\nfunction () {\n  /**\n   * Inject the observer to be used.\n   * @constructor\n   * @access private\n   * @param {Promise<observer.ResultStreamObserver>} streamObserverPromise\n   * @param {mixed} query - Cypher query to execute\n   * @param {Object} parameters - Map with parameters to use in query\n   * @param {ConnectionHolder} connectionHolder - to be notified when result is either fully consumed or error happened.\n   */\n  function Result(streamObserverPromise, query, parameters, connectionHolder, watermarks) {\n    if (watermarks === void 0) {\n      watermarks = {\n        high: Number.MAX_VALUE,\n        low: Number.MAX_VALUE\n      };\n    }\n    /**\n     * Called when finally the result is done\n     *\n     * *Should not be combined with {@link Result#subscribe} function.*\n     * @param {function()|null} onfinally - function when the promise finished\n     * @return {Promise} promise.\n     */\n\n\n    this[_a] = 'Result';\n    this._stack = captureStacktrace();\n    this._streamObserverPromise = streamObserverPromise;\n    this._p = null;\n    this._query = query;\n    this._parameters = parameters !== null && parameters !== void 0 ? parameters : {};\n    this._connectionHolder = connectionHolder !== null && connectionHolder !== void 0 ? connectionHolder : EMPTY_CONNECTION_HOLDER;\n    this._keys = null;\n    this._summary = null;\n    this._error = null;\n    this._watermarks = watermarks;\n  }\n  /**\n   * Returns a promise for the field keys.\n   *\n   * *Should not be combined with {@link Result#subscribe} function.*\n   *\n   * @public\n   * @returns {Promise<string[]>} - Field keys, in the order they will appear in records.\n   }\n   */\n\n\n  Result.prototype.keys = function () {\n    var _this = this;\n\n    if (this._keys !== null) {\n      return Promise.resolve(this._keys);\n    } else if (this._error !== null) {\n      return Promise.reject(this._error);\n    }\n\n    return new Promise(function (resolve, reject) {\n      _this._streamObserverPromise.then(function (observer) {\n        return observer.subscribe(_this._decorateObserver({\n          onKeys: function (keys) {\n            return resolve(keys);\n          },\n          onError: function (err) {\n            return reject(err);\n          }\n        }));\n      }).catch(reject);\n    });\n  };\n  /**\n   * Returns a promise for the result summary.\n   *\n   * *Should not be combined with {@link Result#subscribe} function.*\n   *\n   * @public\n   * @returns {Promise<ResultSummary>} - Result summary.\n   *\n   */\n\n\n  Result.prototype.summary = function () {\n    var _this = this;\n\n    if (this._summary !== null) {\n      return Promise.resolve(this._summary);\n    } else if (this._error !== null) {\n      return Promise.reject(this._error);\n    }\n\n    return new Promise(function (resolve, reject) {\n      _this._streamObserverPromise.then(function (o) {\n        o.cancel();\n        o.subscribe(_this._decorateObserver({\n          onCompleted: function (summary) {\n            return resolve(summary);\n          },\n          onError: function (err) {\n            return reject(err);\n          }\n        }));\n      }).catch(reject);\n    });\n  };\n  /**\n   * Create and return new Promise\n   *\n   * @private\n   * @return {Promise} new Promise.\n   */\n\n\n  Result.prototype._getOrCreatePromise = function () {\n    var _this = this;\n\n    if (this._p == null) {\n      this._p = new Promise(function (resolve, reject) {\n        var records = [];\n        var observer = {\n          onNext: function (record) {\n            records.push(record);\n          },\n          onCompleted: function (summary) {\n            resolve({\n              records: records,\n              summary: summary\n            });\n          },\n          onError: function (error) {\n            reject(error);\n          }\n        };\n\n        _this.subscribe(observer);\n      });\n    }\n\n    return this._p;\n  };\n  /**\n   * Provides a async iterator over the records in the result.\n   *\n   * *Should not be combined with {@link Result#subscribe} or ${@link Result#then} functions.*\n   *\n   * @public\n   * @returns {PeekableAsyncIterator<Record<R>, ResultSummary>} The async iterator for the Results\n   */\n\n\n  Result.prototype[Symbol.asyncIterator] = function () {\n    var _this = this;\n\n    if (!this.isOpen()) {\n      var error_2 = (0, error_1.newError)('Result is already consumed');\n      return {\n        next: function () {\n          return Promise.reject(error_2);\n        },\n        peek: function () {\n          return Promise.reject(error_2);\n        }\n      };\n    }\n\n    var state = {\n      paused: true,\n      firstRun: true,\n      finished: false\n    };\n\n    var controlFlow = function () {\n      var _b, _c;\n\n      if (state.streaming == null) {\n        return;\n      }\n\n      var size = (_c = (_b = state.queuedObserver) === null || _b === void 0 ? void 0 : _b.size) !== null && _c !== void 0 ? _c : 0;\n      var queueSizeIsOverHighOrEqualWatermark = size >= _this._watermarks.high;\n      var queueSizeIsBellowOrEqualLowWatermark = size <= _this._watermarks.low;\n\n      if (queueSizeIsOverHighOrEqualWatermark && !state.paused) {\n        state.paused = true;\n        state.streaming.pause();\n      } else if (queueSizeIsBellowOrEqualLowWatermark && state.paused || state.firstRun && !queueSizeIsOverHighOrEqualWatermark) {\n        state.firstRun = false;\n        state.paused = false;\n        state.streaming.resume();\n      }\n    };\n\n    var initializeObserver = function () {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              if (!(state.queuedObserver === undefined)) return [3\n              /*break*/\n              , 2];\n              state.queuedObserver = this._createQueuedResultObserver(controlFlow);\n              _b = state;\n              return [4\n              /*yield*/\n              , this._subscribe(state.queuedObserver, true).catch(function () {\n                return undefined;\n              })];\n\n            case 1:\n              _b.streaming = _c.sent();\n              controlFlow();\n              _c.label = 2;\n\n            case 2:\n              return [2\n              /*return*/\n              , state.queuedObserver];\n          }\n        });\n      });\n    };\n\n    var assertSummary = function (summary) {\n      if (summary === undefined) {\n        throw (0, error_1.newError)('InvalidState: Result stream finished without Summary', error_1.PROTOCOL_ERROR);\n      }\n\n      return true;\n    };\n\n    return {\n      next: function () {\n        return __awaiter(_this, void 0, void 0, function () {\n          var queuedObserver, next;\n          return __generator(this, function (_b) {\n            switch (_b.label) {\n              case 0:\n                if (state.finished) {\n                  if (assertSummary(state.summary)) {\n                    return [2\n                    /*return*/\n                    , {\n                      done: true,\n                      value: state.summary\n                    }];\n                  }\n                }\n\n                return [4\n                /*yield*/\n                , initializeObserver()];\n\n              case 1:\n                queuedObserver = _b.sent();\n                return [4\n                /*yield*/\n                , queuedObserver.dequeue()];\n\n              case 2:\n                next = _b.sent();\n\n                if (next.done === true) {\n                  state.finished = next.done;\n                  state.summary = next.value;\n                }\n\n                return [2\n                /*return*/\n                , next];\n            }\n          });\n        });\n      },\n      return: function (value) {\n        return __awaiter(_this, void 0, void 0, function () {\n          var queuedObserver, last;\n\n          var _b;\n\n          return __generator(this, function (_c) {\n            switch (_c.label) {\n              case 0:\n                if (state.finished) {\n                  if (assertSummary(state.summary)) {\n                    return [2\n                    /*return*/\n                    , {\n                      done: true,\n                      value: value !== null && value !== void 0 ? value : state.summary\n                    }];\n                  }\n                }\n\n                (_b = state.streaming) === null || _b === void 0 ? void 0 : _b.cancel();\n                return [4\n                /*yield*/\n                , initializeObserver()];\n\n              case 1:\n                queuedObserver = _c.sent();\n                return [4\n                /*yield*/\n                , queuedObserver.dequeueUntilDone()];\n\n              case 2:\n                last = _c.sent();\n                state.finished = true;\n                last.value = value !== null && value !== void 0 ? value : last.value;\n                state.summary = last.value;\n                return [2\n                /*return*/\n                , last];\n            }\n          });\n        });\n      },\n      peek: function () {\n        return __awaiter(_this, void 0, void 0, function () {\n          var queuedObserver;\n          return __generator(this, function (_b) {\n            switch (_b.label) {\n              case 0:\n                if (state.finished) {\n                  if (assertSummary(state.summary)) {\n                    return [2\n                    /*return*/\n                    , {\n                      done: true,\n                      value: state.summary\n                    }];\n                  }\n                }\n\n                return [4\n                /*yield*/\n                , initializeObserver()];\n\n              case 1:\n                queuedObserver = _b.sent();\n                return [4\n                /*yield*/\n                , queuedObserver.head()];\n\n              case 2:\n                return [2\n                /*return*/\n                , _b.sent()];\n            }\n          });\n        });\n      }\n    };\n  };\n  /**\n   * Waits for all results and calls the passed in function with the results.\n   *\n   * *Should not be combined with {@link Result#subscribe} function.*\n   *\n   * @param {function(result: {records:Array<Record>, summary: ResultSummary})} onFulfilled - function to be called\n   * when finished.\n   * @param {function(error: {message:string, code:string})} onRejected - function to be called upon errors.\n   * @return {Promise} promise.\n   */\n\n\n  Result.prototype.then = function (onFulfilled, onRejected) {\n    return this._getOrCreatePromise().then(onFulfilled, onRejected);\n  };\n  /**\n   * Catch errors when using promises.\n   *\n   * *Should not be combined with {@link Result#subscribe} function.*\n   *\n   * @param {function(error: Neo4jError)} onRejected - Function to be called upon errors.\n   * @return {Promise} promise.\n   */\n\n\n  Result.prototype.catch = function (onRejected) {\n    return this._getOrCreatePromise().catch(onRejected);\n  };\n\n  Result.prototype.finally = function (onfinally) {\n    return this._getOrCreatePromise().finally(onfinally);\n  };\n  /**\n   * Stream records to observer as they come in, this is a more efficient method\n   * of handling the results, and allows you to handle arbitrarily large results.\n   *\n   * @param {Object} observer - Observer object\n   * @param {function(keys: string[])} observer.onKeys - handle stream head, the field keys.\n   * @param {function(record: Record)} observer.onNext - handle records, one by one.\n   * @param {function(summary: ResultSummary)} observer.onCompleted - handle stream tail, the result summary.\n   * @param {function(error: {message:string, code:string})} observer.onError - handle errors.\n   * @return {void}\n   */\n\n\n  Result.prototype.subscribe = function (observer) {\n    this._subscribe(observer).catch(function () {});\n  };\n  /**\n   * Check if this result is active, i.e., neither a summary nor an error has been received by the result.\n   * @return {boolean} `true` when neither a summary or nor an error has been received by the result.\n   */\n\n\n  Result.prototype.isOpen = function () {\n    return this._summary === null && this._error === null;\n  };\n  /**\n   * Stream records to observer as they come in, this is a more efficient method\n   * of handling the results, and allows you to handle arbitrarily large results.\n   *\n   * @access private\n   * @param {ResultObserver} observer The observer to send records to.\n   * @param {boolean} paused The flag to indicate if the stream should be started paused\n   * @returns {Promise<observer.ResultStreamObserver>} The result stream observer.\n   */\n\n\n  Result.prototype._subscribe = function (observer, paused) {\n    if (paused === void 0) {\n      paused = false;\n    }\n\n    var _observer = this._decorateObserver(observer);\n\n    return this._streamObserverPromise.then(function (o) {\n      if (paused) {\n        o.pause();\n      }\n\n      o.subscribe(_observer);\n      return o;\n    }).catch(function (error) {\n      if (_observer.onError != null) {\n        _observer.onError(error);\n      }\n\n      return Promise.reject(error);\n    });\n  };\n  /**\n   * Decorates the ResultObserver with the necessary methods.\n   *\n   * @access private\n   * @param {ResultObserver} observer The ResultObserver to decorate.\n   * @returns The decorated result observer\n   */\n\n\n  Result.prototype._decorateObserver = function (observer) {\n    var _this = this;\n\n    var _b, _c, _d;\n\n    var onCompletedOriginal = (_b = observer.onCompleted) !== null && _b !== void 0 ? _b : DEFAULT_ON_COMPLETED;\n    var onErrorOriginal = (_c = observer.onError) !== null && _c !== void 0 ? _c : DEFAULT_ON_ERROR;\n    var onKeysOriginal = (_d = observer.onKeys) !== null && _d !== void 0 ? _d : DEFAULT_ON_KEYS;\n\n    var onCompletedWrapper = function (metadata) {\n      _this._releaseConnectionAndGetSummary(metadata).then(function (summary) {\n        if (_this._summary !== null) {\n          return onCompletedOriginal.call(observer, _this._summary);\n        }\n\n        _this._summary = summary;\n        return onCompletedOriginal.call(observer, summary);\n      }).catch(onErrorOriginal);\n    };\n\n    var onErrorWrapper = function (error) {\n      // notify connection holder that the used connection is not needed any more because error happened\n      // and result can't bee consumed any further; call the original onError callback after that\n      _this._connectionHolder.releaseConnection().then(function () {\n        replaceStacktrace(error, _this._stack);\n        _this._error = error;\n        onErrorOriginal.call(observer, error);\n      }).catch(onErrorOriginal);\n    };\n\n    var onKeysWrapper = function (keys) {\n      _this._keys = keys;\n      return onKeysOriginal.call(observer, keys);\n    };\n\n    return {\n      onNext: observer.onNext != null ? observer.onNext.bind(observer) : undefined,\n      onKeys: onKeysWrapper,\n      onCompleted: onCompletedWrapper,\n      onError: onErrorWrapper\n    };\n  };\n  /**\n   * Signals the stream observer that the future records should be discarded on the server.\n   *\n   * @protected\n   * @since 4.0.0\n   * @returns {void}\n   */\n\n\n  Result.prototype._cancel = function () {\n    if (this._summary === null && this._error === null) {\n      this._streamObserverPromise.then(function (o) {\n        return o.cancel();\n      }).catch(function () {});\n    }\n  };\n  /**\n   * @access private\n   * @param metadata\n   * @returns\n   */\n\n\n  Result.prototype._releaseConnectionAndGetSummary = function (metadata) {\n    var _b = internal_1.util.validateQueryAndParameters(this._query, this._parameters, {\n      skipAsserts: true\n    }),\n        query = _b.validatedQuery,\n        parameters = _b.params;\n\n    var connectionHolder = this._connectionHolder;\n    return connectionHolder.getConnection().then( // onFulfilled:\n    function (connection) {\n      return connectionHolder.releaseConnection().then(function () {\n        return connection === null || connection === void 0 ? void 0 : connection.getProtocolVersion();\n      });\n    }, // onRejected:\n    function (_) {\n      return undefined;\n    }).then(function (protocolVersion) {\n      return new result_summary_1.default(query, parameters, metadata, protocolVersion);\n    });\n  };\n  /**\n   * @access private\n   */\n\n\n  Result.prototype._createQueuedResultObserver = function (onQueueSizeChanged) {\n    var _this = this;\n\n    function createResolvablePromise() {\n      var resolvablePromise = {};\n      resolvablePromise.promise = new Promise(function (resolve, reject) {\n        resolvablePromise.resolve = resolve;\n        resolvablePromise.reject = reject;\n      });\n      return resolvablePromise;\n    }\n\n    function isError(elementOrError) {\n      return elementOrError instanceof Error;\n    }\n\n    function dequeue() {\n      var _b;\n\n      return __awaiter(this, void 0, void 0, function () {\n        var element;\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              if (buffer.length > 0) {\n                element = (_b = buffer.shift()) !== null && _b !== void 0 ? _b : (0, error_1.newError)('Unexpected empty buffer', error_1.PROTOCOL_ERROR);\n                onQueueSizeChanged();\n\n                if (isError(element)) {\n                  throw element;\n                }\n\n                return [2\n                /*return*/\n                , element];\n              }\n\n              promiseHolder.resolvable = createResolvablePromise();\n              return [4\n              /*yield*/\n              , promiseHolder.resolvable.promise];\n\n            case 1:\n              return [2\n              /*return*/\n              , _c.sent()];\n          }\n        });\n      });\n    }\n\n    var buffer = [];\n    var promiseHolder = {\n      resolvable: null\n    };\n    var observer = {\n      onNext: function (record) {\n        observer._push({\n          done: false,\n          value: record\n        });\n      },\n      onCompleted: function (summary) {\n        observer._push({\n          done: true,\n          value: summary\n        });\n      },\n      onError: function (error) {\n        observer._push(error);\n      },\n      _push: function (element) {\n        if (promiseHolder.resolvable !== null) {\n          var resolvable = promiseHolder.resolvable;\n          promiseHolder.resolvable = null;\n\n          if (isError(element)) {\n            resolvable.reject(element);\n          } else {\n            resolvable.resolve(element);\n          }\n        } else {\n          buffer.push(element);\n          onQueueSizeChanged();\n        }\n      },\n      dequeue: dequeue,\n      dequeueUntilDone: function () {\n        return __awaiter(_this, void 0, void 0, function () {\n          var element;\n          return __generator(this, function (_b) {\n            switch (_b.label) {\n              case 0:\n                if (!true) return [3\n                /*break*/\n                , 2];\n                return [4\n                /*yield*/\n                , dequeue()];\n\n              case 1:\n                element = _b.sent();\n\n                if (element.done === true) {\n                  return [2\n                  /*return*/\n                  , element];\n                }\n\n                return [3\n                /*break*/\n                , 0];\n\n              case 2:\n                return [2\n                /*return*/\n                ];\n            }\n          });\n        });\n      },\n      head: function () {\n        return __awaiter(_this, void 0, void 0, function () {\n          var element, element, error_3;\n          return __generator(this, function (_b) {\n            switch (_b.label) {\n              case 0:\n                if (buffer.length > 0) {\n                  element = buffer[0];\n\n                  if (isError(element)) {\n                    throw element;\n                  }\n\n                  return [2\n                  /*return*/\n                  , element];\n                }\n\n                promiseHolder.resolvable = createResolvablePromise();\n                _b.label = 1;\n\n              case 1:\n                _b.trys.push([1, 3, 4, 5]);\n\n                return [4\n                /*yield*/\n                , promiseHolder.resolvable.promise];\n\n              case 2:\n                element = _b.sent();\n                buffer.unshift(element);\n                return [2\n                /*return*/\n                , element];\n\n              case 3:\n                error_3 = _b.sent();\n                buffer.unshift(error_3);\n                throw error_3;\n\n              case 4:\n                onQueueSizeChanged();\n                return [7\n                /*endfinally*/\n                ];\n\n              case 5:\n                return [2\n                /*return*/\n                ];\n            }\n          });\n        });\n      },\n\n      get size() {\n        return buffer.length;\n      }\n\n    };\n    return observer;\n  };\n\n  return Result;\n}();\n\n_a = Symbol.toStringTag;\n\nfunction captureStacktrace() {\n  var error = new Error('');\n\n  if (error.stack != null) {\n    return error.stack.replace(/^Error(\\n\\r)*/, ''); // we don't need the 'Error\\n' part, if only it exists\n  }\n\n  return null;\n}\n/**\n * @private\n * @param {Error} error The error\n * @param {string| null} newStack The newStack\n * @returns {void}\n */\n\n\nfunction replaceStacktrace(error, newStack) {\n  if (newStack != null) {\n    // Error.prototype.toString() concatenates error.name and error.message nicely\n    // then we add the rest of the stack trace\n    // eslint-disable-next-line @typescript-eslint/no-base-to-string\n    error.stack = error.toString() + '\\n' + newStack;\n  }\n}\n\nexports.default = Result;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","__importDefault","mod","__esModule","_a","Object","defineProperty","exports","result_summary_1","require","internal_1","error_1","EMPTY_CONNECTION_HOLDER","connectionHolder","DEFAULT_ON_ERROR","error","console","log","DEFAULT_ON_COMPLETED","summary","DEFAULT_ON_KEYS","keys","Result","streamObserverPromise","query","parameters","watermarks","high","Number","MAX_VALUE","low","_stack","captureStacktrace","_streamObserverPromise","_p","_query","_parameters","_connectionHolder","_keys","_summary","_error","_watermarks","prototype","_this","observer","subscribe","_decorateObserver","onKeys","onError","err","catch","o","cancel","onCompleted","_getOrCreatePromise","records","onNext","record","asyncIterator","isOpen","error_2","newError","peek","state","paused","firstRun","finished","controlFlow","_b","_c","streaming","size","queuedObserver","queueSizeIsOverHighOrEqualWatermark","queueSizeIsBellowOrEqualLowWatermark","pause","resume","initializeObserver","undefined","_createQueuedResultObserver","_subscribe","assertSummary","PROTOCOL_ERROR","dequeue","return","last","dequeueUntilDone","head","onFulfilled","onRejected","finally","onfinally","_observer","_d","onCompletedOriginal","onErrorOriginal","onKeysOriginal","onCompletedWrapper","metadata","_releaseConnectionAndGetSummary","onErrorWrapper","releaseConnection","replaceStacktrace","onKeysWrapper","bind","_cancel","util","validateQueryAndParameters","skipAsserts","validatedQuery","params","getConnection","connection","getProtocolVersion","protocolVersion","default","onQueueSizeChanged","createResolvablePromise","resolvablePromise","promise","isError","elementOrError","Error","element","buffer","shift","promiseHolder","resolvable","_push","error_3","unshift","toStringTag","stack","replace","newStack","toString"],"sources":["C:/projects/levelUp_v1/Level-Up-FN/Level-Up-Fronten-master/node_modules/neo4j-driver-core/lib/result.js"],"sourcesContent":["\"use strict\";\n/**\n * Copyright (c) \"Neo4j\"\n * Neo4j Sweden AB [https://neo4j.com]\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nvar _a;\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* eslint-disable @typescript-eslint/promise-function-async */\nvar result_summary_1 = __importDefault(require(\"./result-summary\"));\nvar internal_1 = require(\"./internal\");\nvar error_1 = require(\"./error\");\nvar EMPTY_CONNECTION_HOLDER = internal_1.connectionHolder.EMPTY_CONNECTION_HOLDER;\n/**\n * @private\n * @param {Error} error The error\n * @returns {void}\n */\nvar DEFAULT_ON_ERROR = function (error) {\n    // eslint-disable-next-line @typescript-eslint/restrict-plus-operands, @typescript-eslint/no-base-to-string\n    console.log('Uncaught error when processing result: ' + error);\n};\n/**\n * @private\n * @param {ResultSummary} summary\n * @returns {void}\n */\nvar DEFAULT_ON_COMPLETED = function (summary) { };\n/**\n * @private\n * @param {string[]} keys List of keys of the record in the result\n * @return {void}\n */\nvar DEFAULT_ON_KEYS = function (keys) { };\n/**\n * A stream of {@link Record} representing the result of a query.\n * Can be consumed eagerly as {@link Promise} resolved with array of records and {@link ResultSummary}\n * summary, or rejected with error that contains {@link string} code and {@link string} message.\n * Alternatively can be consumed lazily using {@link Result#subscribe} function.\n * @access public\n */\nvar Result = /** @class */ (function () {\n    /**\n     * Inject the observer to be used.\n     * @constructor\n     * @access private\n     * @param {Promise<observer.ResultStreamObserver>} streamObserverPromise\n     * @param {mixed} query - Cypher query to execute\n     * @param {Object} parameters - Map with parameters to use in query\n     * @param {ConnectionHolder} connectionHolder - to be notified when result is either fully consumed or error happened.\n     */\n    function Result(streamObserverPromise, query, parameters, connectionHolder, watermarks) {\n        if (watermarks === void 0) { watermarks = { high: Number.MAX_VALUE, low: Number.MAX_VALUE }; }\n        /**\n         * Called when finally the result is done\n         *\n         * *Should not be combined with {@link Result#subscribe} function.*\n         * @param {function()|null} onfinally - function when the promise finished\n         * @return {Promise} promise.\n         */\n        this[_a] = 'Result';\n        this._stack = captureStacktrace();\n        this._streamObserverPromise = streamObserverPromise;\n        this._p = null;\n        this._query = query;\n        this._parameters = parameters !== null && parameters !== void 0 ? parameters : {};\n        this._connectionHolder = connectionHolder !== null && connectionHolder !== void 0 ? connectionHolder : EMPTY_CONNECTION_HOLDER;\n        this._keys = null;\n        this._summary = null;\n        this._error = null;\n        this._watermarks = watermarks;\n    }\n    /**\n     * Returns a promise for the field keys.\n     *\n     * *Should not be combined with {@link Result#subscribe} function.*\n     *\n     * @public\n     * @returns {Promise<string[]>} - Field keys, in the order they will appear in records.\n     }\n     */\n    Result.prototype.keys = function () {\n        var _this = this;\n        if (this._keys !== null) {\n            return Promise.resolve(this._keys);\n        }\n        else if (this._error !== null) {\n            return Promise.reject(this._error);\n        }\n        return new Promise(function (resolve, reject) {\n            _this._streamObserverPromise\n                .then(function (observer) {\n                return observer.subscribe(_this._decorateObserver({\n                    onKeys: function (keys) { return resolve(keys); },\n                    onError: function (err) { return reject(err); }\n                }));\n            })\n                .catch(reject);\n        });\n    };\n    /**\n     * Returns a promise for the result summary.\n     *\n     * *Should not be combined with {@link Result#subscribe} function.*\n     *\n     * @public\n     * @returns {Promise<ResultSummary>} - Result summary.\n     *\n     */\n    Result.prototype.summary = function () {\n        var _this = this;\n        if (this._summary !== null) {\n            return Promise.resolve(this._summary);\n        }\n        else if (this._error !== null) {\n            return Promise.reject(this._error);\n        }\n        return new Promise(function (resolve, reject) {\n            _this._streamObserverPromise\n                .then(function (o) {\n                o.cancel();\n                o.subscribe(_this._decorateObserver({\n                    onCompleted: function (summary) { return resolve(summary); },\n                    onError: function (err) { return reject(err); }\n                }));\n            })\n                .catch(reject);\n        });\n    };\n    /**\n     * Create and return new Promise\n     *\n     * @private\n     * @return {Promise} new Promise.\n     */\n    Result.prototype._getOrCreatePromise = function () {\n        var _this = this;\n        if (this._p == null) {\n            this._p = new Promise(function (resolve, reject) {\n                var records = [];\n                var observer = {\n                    onNext: function (record) {\n                        records.push(record);\n                    },\n                    onCompleted: function (summary) {\n                        resolve({ records: records, summary: summary });\n                    },\n                    onError: function (error) {\n                        reject(error);\n                    }\n                };\n                _this.subscribe(observer);\n            });\n        }\n        return this._p;\n    };\n    /**\n     * Provides a async iterator over the records in the result.\n     *\n     * *Should not be combined with {@link Result#subscribe} or ${@link Result#then} functions.*\n     *\n     * @public\n     * @returns {PeekableAsyncIterator<Record<R>, ResultSummary>} The async iterator for the Results\n     */\n    Result.prototype[Symbol.asyncIterator] = function () {\n        var _this = this;\n        if (!this.isOpen()) {\n            var error_2 = (0, error_1.newError)('Result is already consumed');\n            return {\n                next: function () { return Promise.reject(error_2); },\n                peek: function () { return Promise.reject(error_2); }\n            };\n        }\n        var state = { paused: true, firstRun: true, finished: false };\n        var controlFlow = function () {\n            var _b, _c;\n            if (state.streaming == null) {\n                return;\n            }\n            var size = (_c = (_b = state.queuedObserver) === null || _b === void 0 ? void 0 : _b.size) !== null && _c !== void 0 ? _c : 0;\n            var queueSizeIsOverHighOrEqualWatermark = size >= _this._watermarks.high;\n            var queueSizeIsBellowOrEqualLowWatermark = size <= _this._watermarks.low;\n            if (queueSizeIsOverHighOrEqualWatermark && !state.paused) {\n                state.paused = true;\n                state.streaming.pause();\n            }\n            else if ((queueSizeIsBellowOrEqualLowWatermark && state.paused) || (state.firstRun && !queueSizeIsOverHighOrEqualWatermark)) {\n                state.firstRun = false;\n                state.paused = false;\n                state.streaming.resume();\n            }\n        };\n        var initializeObserver = function () { return __awaiter(_this, void 0, void 0, function () {\n            var _b;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (!(state.queuedObserver === undefined)) return [3 /*break*/, 2];\n                        state.queuedObserver = this._createQueuedResultObserver(controlFlow);\n                        _b = state;\n                        return [4 /*yield*/, this._subscribe(state.queuedObserver, true).catch(function () { return undefined; })];\n                    case 1:\n                        _b.streaming = _c.sent();\n                        controlFlow();\n                        _c.label = 2;\n                    case 2: return [2 /*return*/, state.queuedObserver];\n                }\n            });\n        }); };\n        var assertSummary = function (summary) {\n            if (summary === undefined) {\n                throw (0, error_1.newError)('InvalidState: Result stream finished without Summary', error_1.PROTOCOL_ERROR);\n            }\n            return true;\n        };\n        return {\n            next: function () { return __awaiter(_this, void 0, void 0, function () {\n                var queuedObserver, next;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            if (state.finished) {\n                                if (assertSummary(state.summary)) {\n                                    return [2 /*return*/, { done: true, value: state.summary }];\n                                }\n                            }\n                            return [4 /*yield*/, initializeObserver()];\n                        case 1:\n                            queuedObserver = _b.sent();\n                            return [4 /*yield*/, queuedObserver.dequeue()];\n                        case 2:\n                            next = _b.sent();\n                            if (next.done === true) {\n                                state.finished = next.done;\n                                state.summary = next.value;\n                            }\n                            return [2 /*return*/, next];\n                    }\n                });\n            }); },\n            return: function (value) { return __awaiter(_this, void 0, void 0, function () {\n                var queuedObserver, last;\n                var _b;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            if (state.finished) {\n                                if (assertSummary(state.summary)) {\n                                    return [2 /*return*/, { done: true, value: value !== null && value !== void 0 ? value : state.summary }];\n                                }\n                            }\n                            (_b = state.streaming) === null || _b === void 0 ? void 0 : _b.cancel();\n                            return [4 /*yield*/, initializeObserver()];\n                        case 1:\n                            queuedObserver = _c.sent();\n                            return [4 /*yield*/, queuedObserver.dequeueUntilDone()];\n                        case 2:\n                            last = _c.sent();\n                            state.finished = true;\n                            last.value = value !== null && value !== void 0 ? value : last.value;\n                            state.summary = last.value;\n                            return [2 /*return*/, last];\n                    }\n                });\n            }); },\n            peek: function () { return __awaiter(_this, void 0, void 0, function () {\n                var queuedObserver;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            if (state.finished) {\n                                if (assertSummary(state.summary)) {\n                                    return [2 /*return*/, { done: true, value: state.summary }];\n                                }\n                            }\n                            return [4 /*yield*/, initializeObserver()];\n                        case 1:\n                            queuedObserver = _b.sent();\n                            return [4 /*yield*/, queuedObserver.head()];\n                        case 2: return [2 /*return*/, _b.sent()];\n                    }\n                });\n            }); }\n        };\n    };\n    /**\n     * Waits for all results and calls the passed in function with the results.\n     *\n     * *Should not be combined with {@link Result#subscribe} function.*\n     *\n     * @param {function(result: {records:Array<Record>, summary: ResultSummary})} onFulfilled - function to be called\n     * when finished.\n     * @param {function(error: {message:string, code:string})} onRejected - function to be called upon errors.\n     * @return {Promise} promise.\n     */\n    Result.prototype.then = function (onFulfilled, onRejected) {\n        return this._getOrCreatePromise().then(onFulfilled, onRejected);\n    };\n    /**\n     * Catch errors when using promises.\n     *\n     * *Should not be combined with {@link Result#subscribe} function.*\n     *\n     * @param {function(error: Neo4jError)} onRejected - Function to be called upon errors.\n     * @return {Promise} promise.\n     */\n    Result.prototype.catch = function (onRejected) {\n        return this._getOrCreatePromise().catch(onRejected);\n    };\n    Result.prototype.finally = function (onfinally) {\n        return this._getOrCreatePromise().finally(onfinally);\n    };\n    /**\n     * Stream records to observer as they come in, this is a more efficient method\n     * of handling the results, and allows you to handle arbitrarily large results.\n     *\n     * @param {Object} observer - Observer object\n     * @param {function(keys: string[])} observer.onKeys - handle stream head, the field keys.\n     * @param {function(record: Record)} observer.onNext - handle records, one by one.\n     * @param {function(summary: ResultSummary)} observer.onCompleted - handle stream tail, the result summary.\n     * @param {function(error: {message:string, code:string})} observer.onError - handle errors.\n     * @return {void}\n     */\n    Result.prototype.subscribe = function (observer) {\n        this._subscribe(observer)\n            .catch(function () { });\n    };\n    /**\n     * Check if this result is active, i.e., neither a summary nor an error has been received by the result.\n     * @return {boolean} `true` when neither a summary or nor an error has been received by the result.\n     */\n    Result.prototype.isOpen = function () {\n        return this._summary === null && this._error === null;\n    };\n    /**\n     * Stream records to observer as they come in, this is a more efficient method\n     * of handling the results, and allows you to handle arbitrarily large results.\n     *\n     * @access private\n     * @param {ResultObserver} observer The observer to send records to.\n     * @param {boolean} paused The flag to indicate if the stream should be started paused\n     * @returns {Promise<observer.ResultStreamObserver>} The result stream observer.\n     */\n    Result.prototype._subscribe = function (observer, paused) {\n        if (paused === void 0) { paused = false; }\n        var _observer = this._decorateObserver(observer);\n        return this._streamObserverPromise\n            .then(function (o) {\n            if (paused) {\n                o.pause();\n            }\n            o.subscribe(_observer);\n            return o;\n        })\n            .catch(function (error) {\n            if (_observer.onError != null) {\n                _observer.onError(error);\n            }\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Decorates the ResultObserver with the necessary methods.\n     *\n     * @access private\n     * @param {ResultObserver} observer The ResultObserver to decorate.\n     * @returns The decorated result observer\n     */\n    Result.prototype._decorateObserver = function (observer) {\n        var _this = this;\n        var _b, _c, _d;\n        var onCompletedOriginal = (_b = observer.onCompleted) !== null && _b !== void 0 ? _b : DEFAULT_ON_COMPLETED;\n        var onErrorOriginal = (_c = observer.onError) !== null && _c !== void 0 ? _c : DEFAULT_ON_ERROR;\n        var onKeysOriginal = (_d = observer.onKeys) !== null && _d !== void 0 ? _d : DEFAULT_ON_KEYS;\n        var onCompletedWrapper = function (metadata) {\n            _this._releaseConnectionAndGetSummary(metadata).then(function (summary) {\n                if (_this._summary !== null) {\n                    return onCompletedOriginal.call(observer, _this._summary);\n                }\n                _this._summary = summary;\n                return onCompletedOriginal.call(observer, summary);\n            }).catch(onErrorOriginal);\n        };\n        var onErrorWrapper = function (error) {\n            // notify connection holder that the used connection is not needed any more because error happened\n            // and result can't bee consumed any further; call the original onError callback after that\n            _this._connectionHolder.releaseConnection().then(function () {\n                replaceStacktrace(error, _this._stack);\n                _this._error = error;\n                onErrorOriginal.call(observer, error);\n            }).catch(onErrorOriginal);\n        };\n        var onKeysWrapper = function (keys) {\n            _this._keys = keys;\n            return onKeysOriginal.call(observer, keys);\n        };\n        return {\n            onNext: (observer.onNext != null) ? observer.onNext.bind(observer) : undefined,\n            onKeys: onKeysWrapper,\n            onCompleted: onCompletedWrapper,\n            onError: onErrorWrapper\n        };\n    };\n    /**\n     * Signals the stream observer that the future records should be discarded on the server.\n     *\n     * @protected\n     * @since 4.0.0\n     * @returns {void}\n     */\n    Result.prototype._cancel = function () {\n        if (this._summary === null && this._error === null) {\n            this._streamObserverPromise.then(function (o) { return o.cancel(); })\n                .catch(function () { });\n        }\n    };\n    /**\n     * @access private\n     * @param metadata\n     * @returns\n     */\n    Result.prototype._releaseConnectionAndGetSummary = function (metadata) {\n        var _b = internal_1.util.validateQueryAndParameters(this._query, this._parameters, {\n            skipAsserts: true\n        }), query = _b.validatedQuery, parameters = _b.params;\n        var connectionHolder = this._connectionHolder;\n        return connectionHolder\n            .getConnection()\n            .then(\n        // onFulfilled:\n        function (connection) {\n            return connectionHolder\n                .releaseConnection()\n                .then(function () {\n                return connection === null || connection === void 0 ? void 0 : connection.getProtocolVersion();\n            });\n        }, \n        // onRejected:\n        function (_) { return undefined; })\n            .then(function (protocolVersion) {\n            return new result_summary_1.default(query, parameters, metadata, protocolVersion);\n        });\n    };\n    /**\n     * @access private\n     */\n    Result.prototype._createQueuedResultObserver = function (onQueueSizeChanged) {\n        var _this = this;\n        function createResolvablePromise() {\n            var resolvablePromise = {};\n            resolvablePromise.promise = new Promise(function (resolve, reject) {\n                resolvablePromise.resolve = resolve;\n                resolvablePromise.reject = reject;\n            });\n            return resolvablePromise;\n        }\n        function isError(elementOrError) {\n            return elementOrError instanceof Error;\n        }\n        function dequeue() {\n            var _b;\n            return __awaiter(this, void 0, void 0, function () {\n                var element;\n                return __generator(this, function (_c) {\n                    switch (_c.label) {\n                        case 0:\n                            if (buffer.length > 0) {\n                                element = (_b = buffer.shift()) !== null && _b !== void 0 ? _b : (0, error_1.newError)('Unexpected empty buffer', error_1.PROTOCOL_ERROR);\n                                onQueueSizeChanged();\n                                if (isError(element)) {\n                                    throw element;\n                                }\n                                return [2 /*return*/, element];\n                            }\n                            promiseHolder.resolvable = createResolvablePromise();\n                            return [4 /*yield*/, promiseHolder.resolvable.promise];\n                        case 1: return [2 /*return*/, _c.sent()];\n                    }\n                });\n            });\n        }\n        var buffer = [];\n        var promiseHolder = { resolvable: null };\n        var observer = {\n            onNext: function (record) {\n                observer._push({ done: false, value: record });\n            },\n            onCompleted: function (summary) {\n                observer._push({ done: true, value: summary });\n            },\n            onError: function (error) {\n                observer._push(error);\n            },\n            _push: function (element) {\n                if (promiseHolder.resolvable !== null) {\n                    var resolvable = promiseHolder.resolvable;\n                    promiseHolder.resolvable = null;\n                    if (isError(element)) {\n                        resolvable.reject(element);\n                    }\n                    else {\n                        resolvable.resolve(element);\n                    }\n                }\n                else {\n                    buffer.push(element);\n                    onQueueSizeChanged();\n                }\n            },\n            dequeue: dequeue,\n            dequeueUntilDone: function () { return __awaiter(_this, void 0, void 0, function () {\n                var element;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            if (!true) return [3 /*break*/, 2];\n                            return [4 /*yield*/, dequeue()];\n                        case 1:\n                            element = _b.sent();\n                            if (element.done === true) {\n                                return [2 /*return*/, element];\n                            }\n                            return [3 /*break*/, 0];\n                        case 2: return [2 /*return*/];\n                    }\n                });\n            }); },\n            head: function () { return __awaiter(_this, void 0, void 0, function () {\n                var element, element, error_3;\n                return __generator(this, function (_b) {\n                    switch (_b.label) {\n                        case 0:\n                            if (buffer.length > 0) {\n                                element = buffer[0];\n                                if (isError(element)) {\n                                    throw element;\n                                }\n                                return [2 /*return*/, element];\n                            }\n                            promiseHolder.resolvable = createResolvablePromise();\n                            _b.label = 1;\n                        case 1:\n                            _b.trys.push([1, 3, 4, 5]);\n                            return [4 /*yield*/, promiseHolder.resolvable.promise];\n                        case 2:\n                            element = _b.sent();\n                            buffer.unshift(element);\n                            return [2 /*return*/, element];\n                        case 3:\n                            error_3 = _b.sent();\n                            buffer.unshift(error_3);\n                            throw error_3;\n                        case 4:\n                            onQueueSizeChanged();\n                            return [7 /*endfinally*/];\n                        case 5: return [2 /*return*/];\n                    }\n                });\n            }); },\n            get size() {\n                return buffer.length;\n            }\n        };\n        return observer;\n    };\n    return Result;\n}());\n_a = Symbol.toStringTag;\nfunction captureStacktrace() {\n    var error = new Error('');\n    if (error.stack != null) {\n        return error.stack.replace(/^Error(\\n\\r)*/, ''); // we don't need the 'Error\\n' part, if only it exists\n    }\n    return null;\n}\n/**\n * @private\n * @param {Error} error The error\n * @param {string| null} newStack The newStack\n * @returns {void}\n */\nfunction replaceStacktrace(error, newStack) {\n    if (newStack != null) {\n        // Error.prototype.toString() concatenates error.name and error.message nicely\n        // then we add the rest of the stack trace\n        // eslint-disable-next-line @typescript-eslint/no-base-to-string\n        error.stack = error.toString() + '\\n' + newStack;\n    }\n}\nexports.default = Result;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}